#!/usr/bin/env bash
set -euo pipefail
resolve_path() {
  python3 - "$1" <<'PY'
import os, sys
print(os.path.realpath(sys.argv[1]))
PY
}

SCRIPT_PATH="$(resolve_path "${BASH_SOURCE[0]}")"
SCRIPT_DIR="$(cd "$(dirname "${SCRIPT_PATH}")" && pwd)"

if [[ "$#" -gt 0 && "$1" == "--prompt" ]]; then
  shift
  PROMPT_VALUE="${1:-}"
  [[ -z "${PROMPT_VALUE}" ]] && { echo "Usage: agentbox-claude --prompt <text>"; exit 1; }
  exec "${SCRIPT_DIR}/agentbox-run" claude -- claude --print --permission-mode bypassPermissions --model sonnet --output-format text -- "${PROMPT_VALUE}"
fi

AGENTBOX_AGENT="claude" exec "${SCRIPT_DIR}/agentbox-run" "$@"
